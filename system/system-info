#!/bin/bash

# System Information Script
# Displays comprehensive system information in a user-friendly format

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
NC='\033[0m' # No Color

# Header
echo -e "${WHITE}========================================${NC}"
echo -e "${WHITE}         SYSTEM INFORMATION             ${NC}"
echo -e "${WHITE}========================================${NC}"
echo

# Basic System Info
echo -e "${CYAN}ðŸ–¥ï¸  SYSTEM OVERVIEW${NC}"
echo -e "${GREEN}Hostname:${NC} $(hostname)"
echo -e "${GREEN}OS:${NC} $(lsb_release -d 2>/dev/null | cut -f2 || cat /etc/os-release | grep PRETTY_NAME | cut -d'"' -f2)"
echo -e "${GREEN}Kernel:${NC} $(uname -r)"
echo -e "${GREEN}Architecture:${NC} $(uname -m)"
echo -e "${GREEN}Uptime:${NC} $(uptime -p 2>/dev/null || uptime | cut -d',' -f1 | cut -d' ' -f3-)"
echo -e "${GREEN}Current Time:${NC} $(date)"
echo

# CPU Information
echo -e "${CYAN}âš¡ CPU INFORMATION${NC}"
CPU_MODEL=$(grep "model name" /proc/cpuinfo | head -1 | cut -d':' -f2 | sed 's/^ *//')
CPU_CORES=$(nproc)
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
echo -e "${GREEN}Model:${NC} $CPU_MODEL"
echo -e "${GREEN}Cores:${NC} $CPU_CORES"
echo -e "${GREEN}Current Usage:${NC} $CPU_USAGE%"
echo

# Memory Information
echo -e "${CYAN}ðŸ’¾ MEMORY INFORMATION${NC}"
MEMORY_INFO=$(free -h | grep "Mem:")
TOTAL_MEM=$(echo $MEMORY_INFO | awk '{print $2}')
USED_MEM=$(echo $MEMORY_INFO | awk '{print $3}')
FREE_MEM=$(echo $MEMORY_INFO | awk '{print $4}')
AVAILABLE_MEM=$(echo $MEMORY_INFO | awk '{print $7}')
echo -e "${GREEN}Total:${NC} $TOTAL_MEM"
echo -e "${GREEN}Used:${NC} $USED_MEM"
echo -e "${GREEN}Free:${NC} $FREE_MEM"
echo -e "${GREEN}Available:${NC} $AVAILABLE_MEM"
echo

# Disk Usage
echo -e "${CYAN}ðŸ’¿ DISK USAGE${NC}"
df -h | grep -E '^/dev/' | while read line; do
    DEVICE=$(echo $line | awk '{print $1}')
    SIZE=$(echo $line | awk '{print $2}')
    USED=$(echo $line | awk '{print $3}')
    AVAILABLE=$(echo $line | awk '{print $4}')
    PERCENT=$(echo $line | awk '{print $5}')
    MOUNT=$(echo $line | awk '{print $6}')
    echo -e "${GREEN}$MOUNT${NC} ($DEVICE): ${YELLOW}$USED${NC}/${BLUE}$SIZE${NC} (${MAGENTA}$PERCENT${NC})"
done
echo

# Network Information
echo -e "${CYAN}ðŸŒ NETWORK INFORMATION${NC}"
INTERFACES=$(ip -o link show | awk -F': ' '{print $2}' | grep -v lo)
for INTERFACE in $INTERFACES; do
    IP=$(ip -4 addr show $INTERFACE 2>/dev/null | grep inet | awk '{print $2}' | cut -d'/' -f1 | head -1)
    if [ ! -z "$IP" ]; then
        echo -e "${GREEN}$INTERFACE:${NC} $IP"
    fi
done

# Public IP (if available)
PUBLIC_IP=$(curl -s -m 5 ifconfig.me 2>/dev/null || echo "Unable to retrieve")
echo -e "${GREEN}Public IP:${NC} $PUBLIC_IP"
echo

# Currently logged in users
echo -e "${CYAN}ðŸ‘¥ LOGGED IN USERS${NC}"
who | while read line; do
    echo -e "${GREEN}$line${NC}"
done
echo

# Top 5 processes by CPU usage
echo -e "${CYAN}ðŸ”¥ TOP 5 PROCESSES (CPU)${NC}"
ps aux --sort=-%cpu | head -6 | tail -5 | awk '{printf "%-20s %5s%% %s\n", $11, $3, $1}'
echo

# Top 5 processes by Memory usage
echo -e "${CYAN}ðŸ§  TOP 5 PROCESSES (MEMORY)${NC}"
ps aux --sort=-%mem | head -6 | tail -5 | awk '{printf "%-20s %5s%% %s\n", $11, $4, $1}'
echo

# System Load
echo -e "${CYAN}ðŸ“Š SYSTEM LOAD${NC}"
LOAD=$(cat /proc/loadavg | awk '{print $1, $2, $3}')
echo -e "${GREEN}Load Average:${NC} $LOAD (1min, 5min, 15min)"
echo

# Footer
echo -e "${WHITE}========================================${NC}"
